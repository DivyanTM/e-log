<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Oil Record Book Part II - ELOG</title>
    <!-- plugins:css -->
    <link
      rel="stylesheet"
      href="assets/vendors/mdi/css/materialdesignicons.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/css/vendor.bundle.base.css" />
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link
      rel="stylesheet"
      href="assets/vendors/jvectormap/jquery-jvectormap.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/flag-icon-css/css/flag-icon.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/owl-carousel-2/owl.carousel.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/owl-carousel-2/owl.theme.default.min.css"
    />
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <style>
      #website-name {
        transition: opacity 0.3s;
      }
      #website-name.d-none {
        opacity: 0;
      }
      #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }

      #preloader-content {
        text-align: center;
      }
      .operation-details-container {
        line-height: 1.6;
        white-space: normal;
      }
      

      #preloader-content img {
        width: 150px;
        height: auto;
      }

      #preloader.hide {
        display: none;
      }
    </style>
    <link rel="stylesheet" href="assets/css/style.css" />
    <!-- End layout styles -->
    <!-- <link rel="shortcut icon" href="assets/images/favicon.png" /> -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ag-grid-community@latest/styles/ag-theme-quartz-dark.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@latest/dist/ag-grid-community.min.js"></script>
  </head>
  <body>
    <div id="preloader">
      <div id="preloader-content">
        <img src="assets/gifs/ship1.gif" alt="Loading..." />
        <p class="mt-3">Loading...</p>
      </div>
    </div>
    <div class="container-scroller">
      <!-- partial:partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <div
          class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top"
        >
          <a
            class="sidebar-brand text-decoration-none text-white d-flex align-items-center gap-2"
            href="index.html"
          >
            <span
              class="mdi mdi-database fs-6 text-success"
              style="font-size: 2rem !important"
            ></span>
            <span class="fs-6" id="website-name">ELOG</span>
          </a>
        </div>

        <ul class="nav">
          <li class="nav-item menu-items">
            <a class="nav-link" href="index.html">
              <span class="menu-icon">
                <i class="mdi mdi-speedometer text-gray"></i>
              </span>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" data-toggle="collapse" href="#ui-basic" aria-expanded="false" aria-controls="ui-basic">
              <span class="menu-icon">
                <i class="mdi mdi-file-document-edit-outline text-gray"></i>
              </span>
              <span class="menu-title">Forms</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="ui-basic">
              <ul class="nav flex-column sub-menu">
                <!-- ORB1 and ORB2 -->
                <li class="nav-item">
                    <a class="nav-link" href="orb1.html" style="font-size: 16px;">
                        <i class="mdi mdi-oil text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ORB-I
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="orb2.html" style="font-size: 16px;">
                        <i class="mdi mdi-fuel text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ORB-II
                    </a>
                </li>
            
                <!-- GRB -->
                <li class="nav-item">
                    <a class="nav-link" href="grb.html" style="font-size: 16px;">
                        <i class="mdi mdi-trash-can text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Garbage RB
                    </a>
                </li>
            
                <!-- CRB -->
                <li class="nav-item">
                    <a class="nav-link" href="crb.html" style="font-size: 16px;">
                        <i class="mdi mdi-clipboard-text text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Cargo RB
                    </a>
                </li>
            
                <!-- APR B (NOX Tier Changeover) -->
                <li class="nav-item">
                    <a class="nav-link" href="aprb.html" style="font-size: 16px;">
                        <i class="mdi mdi-swap-horizontal text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        NOX Change
                    </a>
                </li>
            
                <!-- BDR (Bunker Delivery) -->
                <li class="nav-item">
                    <a class="nav-link" href="bdr.html" style="font-size: 16px;">
                        <i class="mdi mdi-gas-station text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Bunker Deliv
                    </a>
                </li>
            
                <!-- BWRB (Ballast Water Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="bwrb.html" style="font-size: 16px;">
                        <i class="mdi mdi-ferry text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Ballast WB
                    </a>
                </li>
            
                <!-- FOR (Fuel Oil Received Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="for.html" style="font-size: 16px;">
                        <i class="mdi mdi-call-received text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Fuel Received
                    </a>
                </li>
            
                <!-- FOS (Fuel Oil Sample Control and Tracking) -->
                <li class="nav-item">
                    <a class="nav-link" href="fos.html" style="font-size: 16px;">
                        <i class="mdi mdi-flask text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Fuel Sample
                    </a>
                </li>
            
                <!-- LSFCO (Low Sulphur Fuel Change Over) -->
                <li class="nav-item">
                    <a class="nav-link" href="lsfco.html" style="font-size: 16px;">
                        <i class="mdi mdi-leaf text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        LSFO Change
                    </a>
                </li>
            
                <!-- ODSRB (Ozone Depleting Substance Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="odsrb.html" style="font-size: 16px;">
                        <i class="mdi mdi-earth text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ODS RB
                    </a>
                </li>
            </ul>
  
  
  
            </div>
          </li>
  
          <li class="nav-item menu-items">
            <a class="nav-link" data-toggle="collapse" href="#ui-basic1" aria-expanded="false" aria-controls="ui-basic">
              <span class="menu-icon">
                <i class="mdi mdi-book-multiple text-gray"></i>
              </span>
              <span class="menu-title">Books</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="ui-basic1">
              <ul class="nav flex-column sub-menu">
                <!-- ORB1 and ORB2 -->
                <li class="nav-item">
                    <a class="nav-link" href="orb1Records.html" style="font-size: 16px;">
                        <i class="mdi mdi-oil text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ORB-I
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="orb2Records.html" style="font-size: 16px;">
                        <i class="mdi mdi-fuel text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ORB-II
                    </a>
                </li>
            
                <!-- GRB -->
                <li class="nav-item">
                    <a class="nav-link" href="grbRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-trash-can text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Garbage RB
                    </a>
                </li>
            
                <!-- CRB -->
                <li class="nav-item">
                    <a class="nav-link" href="crbRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-clipboard-text text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Cargo RB
                    </a>
                </li>
            
                <!-- APR B (NOX Tier Changeover) -->
                <li class="nav-item">
                    <a class="nav-link" href="aprbRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-swap-horizontal text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        NOX Change
                    </a>
                </li>
            
                <!-- BDR (Bunker Delivery) -->
                <li class="nav-item">
                    <a class="nav-link" href="bdrRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-gas-station text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Bunker Deliv
                    </a>
                </li>
            
                <!-- BWRB (Ballast Water Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="bwrbRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-ferry text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Ballast WB
                    </a>
                </li>
            
                <!-- FOR (Fuel Oil Received Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="forRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-call-received text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Fuel Received
                    </a>
                </li>
            
                <!-- FOS (Fuel Oil Sample Control and Tracking) -->
                <li class="nav-item">
                    <a class="nav-link" href="fosRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-flask text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        Fuel Sample
                    </a>
                </li>
            
                <!-- LSFCO (Low Sulphur Fuel Change Over) -->
                <li class="nav-item">
                    <a class="nav-link" href="lsfoRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-leaf text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        LSFO Change
                    </a>
                </li>
            
                <!-- ODSRB (Ozone Depleting Substance Record Book) -->
                <li class="nav-item">
                    <a class="nav-link" href="odsrbRecords.html" style="font-size: 16px;">
                        <i class="mdi mdi-earth text-gray" style="font-size: 20px; margin-right: 8px;"></i>
                        ODS RB
                    </a>
                </li>
            </ul>
  
  
  
            </div>
          </li>
        </ul>
      </nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_navbar.html -->
        <nav class="navbar p-0 fixed-top d-flex flex-row">
          <div
            class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center"
          >
            <span
              class="mdi mdi-database fs-6 text-success"
              style="font-size: 2rem !important"
            ></span>
          </div>
          <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
            <button
              class="navbar-toggler navbar-toggler align-self-center"
              type="button"
              data-toggle="minimize"
            >
              <span class="mdi mdi-menu"></span>
            </button>
          </div>
        </nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="row">
              <div class="col-md-12 stretch-card">
                <div class="card">
                  <div class="card-header">
                    <div class="custom-loader-overlay" id="recordsLoader">
                      <div class="loader-wrapper">
                        <div class="loader"></div>
                        
                      </div>
                    </div>
                    <h2 class="card-title mb-3">Oil Record Book - Part II</h2>
                    <p class="text-secondary">
                      Tracking and Control Record for Cargo/Ballast Operations
                    </p>

                    
                  </div>

                  <div class="card-body">
                    <div
                      id="operationGrid"
                      class="ag-theme-quartz-dark"
                      style="width: 100%; height: 900px"
                    ></div>

                   
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:partials/_footer.html -->
          <footer class="footer"></footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="assets/vendors/js/vendor.bundle.base.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="assets/js/apiRequest.js"></script>
    <script type="module" src="/assets/js/axiosInstance.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="assets/vendors/chart.js/Chart.min.js"></script>
    <script src="assets/vendors/progressbar.js/progressbar.min.js"></script>
    <script src="assets/vendors/jvectormap/jquery-jvectormap.min.js"></script>
    <script src="assets/vendors/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <script src="assets/vendors/owl-carousel-2/owl.carousel.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="assets/js/off-canvas.js"></script>
    <script src="assets/js/hoverable-collapse.js"></script>
    <script src="assets/js/misc.js"></script>
    <script src="assets/js/settings.js"></script>
    <script src="assets/js/todolist.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page -->

    <!-- api -->

    <script src="assets/js/axiosInstance.js"></script>

    <script src="assets/js/dashboard.js"></script>
    <!-- End custom js for this page -->

    <script>
     
      document.addEventListener("DOMContentLoaded", async function () {
        
        const COMMON_COLUMNS = [
          "approvedBy",
          "approvalStatus",
          "createdby",
          
          "createdAt",
          "verifiedby",
          "verifiedAt",
          "verificationStatus",
          "verificationRemarks",
          "operationName"
        ];
      
        const gridDiv = document.getElementById("operationGrid");
        let gridApi;
      
        try {
          
          showRecordsLoader();
          
      
          const response = await axiosInstance.get(`/orb2/retrieve-operations`);
          const data = response.data.records || [];
          console.log("Fetched Data:", data);
      
        
      
          const formattedData = data.map((item) => ({
            ...item,
            letterOfProtestIssued: item.letterOfProtestIssued ? "Yes" : "No",
            approvalStatus: item.approvalStatus ? "Approved" : "Pending",
            monitoringSystem: Boolean(item.monitoringSystem),
            regularCheckup: Boolean(item.regularCheckup),
            washingPattern: Boolean(item.washingPattern),
            valvesClosed: Boolean(item.valvesClosed),
            startTimeWashing: formatTime(item.startTimeWashing),
            settlingLastResidues: formatTime(item.settlingLastResidues),
            timeStart: formatTime(item.timeStart),
            timeCompletion: formatTime(item.timeCompletion),
            timeOfSystemFailure: formatTime(item.timeOfSystemFailure),
            timeSystemOperational: formatTime(item.timeSystemOperational),
            settlingLastDischarge: formatTime(item.settlingLastDischarge),
            valveTime: formatTime(item.valveTime),
            valveCloseTime: formatTime(item.valveCloseTime),
            stopTimeWashing: formatTime(item.stopTimeWashing),
            timeOfOccurrence: formatTime(item.timeOfOccurrence),
            durationOfCleaning: formatTime(item.durationOfCleaning),
            dischargeStartTime: formatTime(item.dischargeStartTime),
            dischargeCompleteTime: formatTime(item.dischargeCompleteTime),
            date: formatDate(item.date),
            createdAt: formatDateTime(item.createdAt),
            dateSampleDestroyed: formatDate(item.dateSampleDestroyed),
            verifiedby: item.verifiedby? item.verifiedby : "-",
            verifiedAt: item.verifiedAt ? formatDateTime(item.verifiedAt) : '-',
            verificationStatus: item.verificationStatus ? "Verified" : "Not Verified",
            verificationRemarks: item.verificationRemarks || "-",
            operationName: item.operationName || "N/A",
            operationDetails: item.details || {},
            approvedBy:item.approvedBy || '-'
          }));
      
          const columnDefs = [
            {
              headerName: "SNO",
              valueGetter: (params) => (params.node ? params.node.rowIndex + 1 : null),
              maxWidth: 80,
              sortable: false,
             
            },
            ...COMMON_COLUMNS.map((col) => ({
              headerName: formatHeaderName(col),
              field: col,
              sortable: true,
              cellClass:"centered-cell",
              filter: true,
              resizable: true,
              cellRenderer: ["approvalStatus", "verificationStatus"].includes(col)
              ? createActionsCellRenderer
              : null            })),
            {
              headerName: "Operation Details",
              field: "operationDetails",
              autoHeight: true,
              flex: 2,
              minWidth:330,
             
              cellRenderer: createOperationDetailsRenderer
            }
          ];
      
          const gridOptions = {
            columnDefs,
            rowData: formattedData,
            pagination: true,
            theme:'legacy',
            paginationPageSize: 20,
            defaultColDef: {
              sortable: true,
              filter: true,
              resizable: true,
              flex: 1,
              minWidth:250,
            },
            onFirstDataRendered: (params) => params.api.sizeColumnsToFit()
          };
      
          gridDiv.innerHTML = "";
          if (gridApi) gridApi.destroy();
          gridApi = agGrid.createGrid(gridDiv, gridOptions);
          gridApi.setGridOption("rowData", formattedData);
          
          gridDiv.style.display = "block";
          hideRecordsLoader();
        } catch (error) {
          console.error("Error fetching records:", error);
          hideRecordsLoader();
          gridDiv.style.display='block';
          gridDiv.innerHTML = "<p class='text-danger'>Failed to load data.</p>";
        }
      
        
        function formatHeaderName(key) {
          return key
            .replace(/([A-Z])/g, " $1")
            .replace(/^./, (str) => str.toUpperCase())
            .trim();
        }
      
        function formatDate(date) {
          return date ? new Date(date).toLocaleDateString("en-GB") : "N/A";
        }

        function formatDateTime(date) {
          return date ? new Date(date).toLocaleString("en-GB") : "N/A";
        }
      
        function formatTime(time) {
          return time
            ? new Date(time).toLocaleString("en-US", {
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit",
                hour12: true
              })
            : "N/A";
        }
      
        function createCheckboxRenderer(params) {
          const div = document.createElement("div");
          div.classList.add("form-check", "form-switch", "d-flex", "justify-content-center");
        
          const toggle = document.createElement("input");
          toggle.type = "checkbox";
          toggle.classList.add("form-check-input");
          toggle.checked = Boolean(params.value);
          toggle.disabled = true;
        
          toggle.style.width = "2.5em";
          toggle.style.height = "1.5em";
          toggle.style.cursor = "not-allowed";
        
          div.appendChild(toggle);
          return div;
        }
            
        function createActionsCellRenderer(params) {
          if (!params || !params.data || !params.colDef || !params.colDef.field) return document.createElement("div");
        
          const field = params.colDef.field; 
          const value = params.data[field]; 
        
          const div = document.createElement("div");
          const btn = document.createElement("button");
        
          btn.innerText = value || "Pending";
          div.classList.add("d-flex", "justify-content-center", "mt-1");
        
          if (value === "Approved" || value === "Verified") {
            btn.classList.add("btn", "btn-success", "w-100", "p-2");
          } else if (value === "Pending" || value === "Not Verified") {
            btn.classList.add("btn", "btn-warning", "w-100", "p-2");
          } else {
            btn.classList.add("btn", "btn-secondary", "w-100", "p-2");
          }
        
          div.appendChild(btn);
          return div;
        }
                
        let currentlyExpandedRenderer = null;
        let currentlyExpandedButton = null;
        
      
        function createOperationDetailsRenderer(params) {
          const details = params.value;
          if (!details || typeof details !== "object") return "N/A";
        
          const container = document.createElement("div");
          container.classList.add("operation-details-container");
          container.style.position = "relative";
        
          const formatValueBlock = (label, value) => {
            const lowerLabel = label.toLowerCase();
        
            if (lowerLabel.includes("date") && lowerLabel.includes("time")) {
              value = formatDateTime(value);
            } else if (lowerLabel.includes("date")) {
              value = formatDate(value);
            } else if (lowerLabel.includes("time")) {
              value = formatTime(value);
            } else if (isISODate(value)) {
              // fallback for untagged datetime strings
              value = formatDateTime(value);
            }
        
            return `<div style="margin: 4px 0;">
                      <label style="font-weight: 500;">${label}:</label> ${value}
                    </div>`;
          };
        
  const renderEntries = (obj) => {
    let result = [];

    for (const [key, val] of Object.entries(obj)) {
      if (Array.isArray(val)) {
        val.forEach((item, index) => {
          if (typeof item === "object" && item !== null) {
            for (const [subKey, subVal] of Object.entries(item)) {
              result.push(formatValueBlock(formatHeaderName(subKey), subVal));
            }
          } else {
            result.push(formatValueBlock(formatHeaderName(key), item));
          }
        });
      } else if (typeof val === "object" && val !== null) {
        // If needed, handle object but avoid nesting
        for (const [subKey, subVal] of Object.entries(val)) {
          result.push(formatValueBlock(formatHeaderName(subKey), subVal));
        }
      } else {
        result.push(formatValueBlock(formatHeaderName(key), val));
      }
    }

    return result;
  };
        
          const contentDiv = document.createElement("div");
          contentDiv.innerHTML = renderEntries(details).join("");
          contentDiv.style.display = "none";
        
          const toggleBtn = document.createElement("button");
          toggleBtn.innerText = "Show more";
          toggleBtn.classList.add("btn", "btn-info", "w-100", "p-2");
        
          toggleBtn.addEventListener("click", (e) => {
            e.stopPropagation();
        
            if (currentlyExpandedRenderer && currentlyExpandedRenderer !== contentDiv) {
              currentlyExpandedRenderer.style.display = "none";
              if (currentlyExpandedButton) {
                currentlyExpandedButton.innerText = "Show more";
              }
            }
        
            const isVisible = contentDiv.style.display === "block";
            contentDiv.style.display = isVisible ? "none" : "block";
            toggleBtn.innerText = isVisible ? "Show more" : "Show less";
        
            currentlyExpandedRenderer = isVisible ? null : contentDiv;
            currentlyExpandedButton = isVisible ? null : toggleBtn;
          });
        
          container.appendChild(toggleBtn);
          container.appendChild(contentDiv);
        
          return container;
        }
        
        // Format label names like startTime => Start Time
        function formatHeaderName(str) {
          return str.replace(/([a-z])([A-Z])/g, "$1 $2").replace(/^./, s => s.toUpperCase());
        }
        
        // Helpers
        function isISODate(value) {
          return typeof value === "string" && /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}/.test(value);
        }
        
        function formatDate(dateStr) {
          const date = new Date(dateStr);
          if (isNaN(date)) return dateStr;
          const day = String(date.getDate()).padStart(2, "0");
          const month = String(date.getMonth() + 1).padStart(2, "0");
          const year = date.getFullYear();
          return `${day}-${month}-${year}`;
        }
        
        function formatTime(dateStr) {
          const date = new Date(dateStr);
          if (isNaN(date)) return dateStr;
          const hours = String(date.getHours()).padStart(2, "0");
          const minutes = String(date.getMinutes()).padStart(2, "0");
          return `${hours}:${minutes}`;
        }
        
        function formatDateTime(dateStr) {
          const date = new Date(dateStr);
          if (isNaN(date)) return dateStr;
          const day = String(date.getDate()).padStart(2, "0");
          const month = String(date.getMonth() + 1).padStart(2, "0");
          const year = date.getFullYear();
          const hours = String(date.getHours()).padStart(2, "0");
          const minutes = String(date.getMinutes()).padStart(2, "0");
          return `${day}-${month}-${year} ${hours}:${minutes}`;
        }
                
        // Helper to format camelCase into "Camel Case"
        function formatHeaderName(str) {
          return str
            .replace(/([a-z])([A-Z])/g, "$1 $2")
            .replace(/^./, s => s.toUpperCase());
        }
              });
              
              
        
                      
            
    </script>
    <script>
      function showRecordsLoader() {
        document.getElementById("recordsLoader").style.display = "flex";
      }
      
      
      function hideRecordsLoader() {
        document.getElementById("recordsLoader").style.display = "none";
      }
      window.addEventListener("load", function () {
        if (!sessionStorage.getItem("token")) {
          window.location.href = "login.html";
        }

        setTimeout(function () {
          const preloader = document.getElementById("preloader");
          preloader.classList.add("hide");
        }, 100);
      });

      document
        .querySelector('[data-toggle="minimize"]')
        .addEventListener("click", function () {
          document.getElementById("website-name").classList.toggle("d-none");
        });
    </script>
  </body>
</html>
